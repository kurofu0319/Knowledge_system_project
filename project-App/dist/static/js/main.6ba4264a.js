(()=>{var e={1239:e=>{e.exports={baseUrl:"http://172.20.255.31:8080",publicPath:"./",build:{assetsPublicPath:"./"}}},89:(e,t,n)=>{"use strict";var o=n(5471),r=n(1239),s=n.n(r),a=n(5353);const i={avatar:"vuex_avatar",name:"vuex_name",roles:"vuex_roles",permissions:"vuex_permissions"},u=i;let c="storage_data",l=[u.avatar,u.name,u.roles,u.permissions];const d={set:function(e,t){if(-1!=l.indexOf(e)){let n=uni.getStorageSync(c);n=n||{},n[e]=t,uni.setStorageSync(c,n)}},get:function(e){let t=uni.getStorageSync(c)||{};return t[e]||""},remove:function(e){let t=uni.getStorageSync(c)||{};delete t[e],uni.setStorageSync(c,t)},clean:function(){uni.removeStorageSync(c)}},h=d,m="App-Token";function p(){return uni.getStorageSync(m)}function f(e){return uni.setStorageSync(m,e)}function g(){return uni.removeStorageSync(m)}const S={401:"认证失败，无法访问系统资源",403:"当前操作没有权限",404:"访问资源不存在",default:"系统未知错误，请反馈给管理员"};function v(e){uni.showToast({icon:"none",title:e})}function T(e){return new Promise(((t,n)=>{uni.showModal({title:"提示",content:e,cancelText:"取消",confirmText:"确定",success:function(e){t(e)}})}))}function y(e){let t="";for(const r of Object.keys(e)){const s=e[r];var n=encodeURIComponent(r)+"=";if(null!==s&&""!==s&&"undefined"!==typeof s)if("object"===typeof s){for(const e of Object.keys(s))if(null!==s[e]&&""!==s[e]&&"undefined"!==typeof s[e]){let n=r+"["+e+"]";var o=encodeURIComponent(n)+"=";t+=o+encodeURIComponent(s[e])+"&"}}else t+=n+encodeURIComponent(s)+"&"}return t}let b=1e4;const w=s().baseUrl,O=e=>{const t=!1===(e.headers||{}).isToken;if(e.header=e.header||{},p()&&!t&&(e.header["Authorization"]="Bearer "+p()),e.params){let t=e.url+"?"+y(e.params);t=t.slice(0,-1),e.url=t}return new Promise(((t,n)=>{uni.request({method:e.method||"get",timeout:e.timeout||b,url:e.baseUrl||w+e.url,data:e.data,header:e.header,dataType:"json"}).then((e=>{let[o,r]=e;if(o)return v("后端接口连接异常"),void n("后端接口连接异常");const s=r.data.code||200,a=S[s]||r.data.msg||S["default"];401===s?(T("登录状态已过期，您可以继续留在该页面，或者重新登录?").then((e=>{e.confirm&&K.dispatch("LogOut").then((e=>{uni.reLaunch({url:"/pages/login"})}))})),n("无效的会话，或者会话已过期，请重新登录。")):500===s?(v(a),n("500")):200!==s&&(v(a),n(s)),t(r.data)})).catch((e=>{let{message:t}=e;"Network Error"===t?t="后端接口连接异常":t.includes("timeout")?t="系统接口请求超时":t.includes("Request failed with status code")&&(t="系统接口"+t.substr(t.length-3)+"异常"),v(t),n(e)}))}))},E=O;function _(e,t,n,o){const r={username:e,password:t,code:n,uuid:o};return E({url:"/login",headers:{isToken:!1},method:"post",data:r})}function P(){return E({url:"/getInfo",method:"get"})}function k(){return E({url:"/logout",method:"post"})}const L=s().baseUrl,x={state:{token:p(),name:h.get(u.name),avatar:h.get(u.avatar),roles:h.get(u.roles),permissions:h.get(u.permissions)},mutations:{SET_TOKEN:(e,t)=>{e.token=t},SET_NAME:(e,t)=>{e.name=t,h.set(u.name,t)},SET_AVATAR:(e,t)=>{e.avatar=t,h.set(u.avatar,t)},SET_ROLES:(e,t)=>{e.roles=t,h.set(u.roles,t)},SET_PERMISSIONS:(e,t)=>{e.permissions=t,h.set(u.permissions,t)}},actions:{Login({commit:e},t){const n=t.username.trim(),o=t.password,r=t.code,s=t.uuid;return new Promise(((t,a)=>{_(n,o,r,s).then((n=>{f(n.token),e("SET_TOKEN",n.token),t()})).catch((e=>{a(e)}))}))},GetInfo({commit:e,state:t}){return new Promise(((t,o)=>{P().then((o=>{const r=o.user,s=null==r||""==r.avatar||null==r.avatar?n(2224):L+r.avatar,a=null==r||""==r.userName||null==r.userName?"":r.userName;o.roles&&o.roles.length>0?(e("SET_ROLES",o.roles),e("SET_PERMISSIONS",o.permissions)):e("SET_ROLES",["ROLE_DEFAULT"]),e("SET_NAME",a),e("SET_AVATAR",s),t(o)})).catch((e=>{o(e)}))}))},LogOut({commit:e,state:t}){return new Promise(((n,o)=>{k(t.token).then((()=>{e("SET_TOKEN",""),e("SET_ROLES",[]),e("SET_PERMISSIONS",[]),g(),h.clean(),n()})).catch((e=>{o(e)}))}))}}},A=x;function R(){return E({url:"/forum/posts",method:"get"})}function j(e){return E({url:"/forum/post",method:"post",data:e})}function N(e,t){return E({url:`/forum/post/${e}`,method:"delete",params:{userName:t}})}const I={posts:[]},M={SET_POSTS(e,t){e.posts=t}},C={fetchPosts({commit:e}){R().then((t=>{e("SET_POSTS",t.data)})).catch((e=>console.error("Failed to fetch posts:",e)))},createPost({dispatch:e},t){j(t).then((()=>{e("fetchPosts")})).catch((e=>console.error("Failed to create post:",e)))},deletePost({dispatch:e},{id:t,userName:n}){N(t,n).then((()=>{e("fetchPosts")})).catch((e=>console.error("Failed to delete post:",e)))}},U={namespaced:!0,state:I,mutations:M,actions:C},$={token:e=>e.user.token,avatar:e=>e.user.avatar,name:e=>e.user.name,roles:e=>e.user.roles,permissions:e=>e.user.permissions},F=$;o["default"].use(a.Ay);const B=new a.Ay.Store({modules:{user:A,forum:U},getters:F}),K=B,q={onLaunch:function(){this.initApp()},methods:{initApp(){this.initConfig(),this.checkLogin()},initConfig(){this.globalData.config=s()},checkLogin(){p()||this.$tab.reLaunch("/pages/login")}}},D=q;var V,z,G=n(1656),H=(0,G.A)(D,V,z,!1,null,null,null);const J=H.exports,Q={reLaunch(e){return uni.reLaunch({url:e})},switchTab(e){return uni.switchTab({url:e})},redirectTo(e){return uni.redirectTo({url:e})},navigateTo(e){return uni.navigateTo({url:e})},navigateBack(){return uni.navigateBack()}};function W(e){const t="*:*:*",n=K.getters&&K.getters.permissions;return!!(e&&e.length>0)&&n.some((n=>t===n||n===e))}function X(e){const t="admin",n=K.getters&&K.getters.roles;return!!(e&&e.length>0)&&n.some((n=>t===n||n===e))}const Y={hasPermi(e){return W(e)},hasPermiOr(e){return e.some((e=>W(e)))},hasPermiAnd(e){return e.every((e=>W(e)))},hasRole(e){return X(e)},hasRoleOr(e){return e.some((e=>X(e)))},hasRoleAnd(e){return e.every((e=>X(e)))}},Z={msg(e){uni.showToast({title:e,icon:"none"})},msgError(e){uni.showToast({title:e,icon:"error"})},msgSuccess(e){uni.showToast({title:e,icon:"success"})},hideMsg(e){uni.hideToast()},alert(e,t){uni.showModal({title:t||"系统提示",content:e,showCancel:!1})},confirm(e,t){return new Promise(((n,o)=>{uni.showModal({title:t||"系统提示",content:e,cancelText:"取消",confirmText:"确定",success:function(e){e.confirm&&n(e.confirm)}})}))},showToast(e){"object"===typeof e?uni.showToast(e):uni.showToast({title:e,icon:"none",duration:2500})},loading(e){uni.showLoading({title:e,icon:"none"})},closeLoading(){uni.hideLoading()}},ee={install(e){e.prototype.$tab=Q,e.prototype.$auth=Y,e.prototype.$modal=Z}},te="/pages/login",ne=["/pages/login","/pages/register","/pages/common/webview/index"];function oe(e){const t=e.split("?")[0];return-1!==ne.indexOf(t)}let re=["navigateTo","redirectTo","reLaunch","switchTab"];re.forEach((e=>{uni.addInterceptor(e,{invoke(e){return p()?(e.url===te&&uni.reLaunch({url:"/"}),!0):!!oe(e.url)||(uni.reLaunch({url:te}),!1)},fail(e){console.log(e)}})}));var se=n(1052),ae=n.n(se);o["default"].use(ae()),o["default"].use(ee),o["default"].config.productionTip=!1,o["default"].prototype.$store=K,J.mpType="app";const ie=new o["default"]({store:K,render:e=>e(J)});ie.$mount()},2224:(e,t,n)=>{"use strict";e.exports=n.p+"static/img/profile.74856f8b.jpg"}},t={};function n(o){var r=t[o];if(void 0!==r)return r.exports;var s=t[o]={id:o,loaded:!1,exports:{}};return e[o](s,s.exports,n),s.loaded=!0,s.exports}n.m=e,(()=>{n.amdO={}})(),(()=>{var e=[];n.O=(t,o,r,s)=>{if(!o){var a=1/0;for(l=0;l<e.length;l++){for(var[o,r,s]=e[l],i=!0,u=0;u<o.length;u++)(!1&s||a>=s)&&Object.keys(n.O).every((e=>n.O[e](o[u])))?o.splice(u--,1):(i=!1,s<a&&(a=s));if(i){e.splice(l--,1);var c=r();void 0!==c&&(t=c)}}return t}s=s||0;for(var l=e.length;l>0&&e[l-1][2]>s;l--)e[l]=e[l-1];e[l]=[o,r,s]}})(),(()=>{n.n=e=>{var t=e&&e.__esModule?()=>e["default"]:()=>e;return n.d(t,{a:t}),t}})(),(()=>{n.d=(e,t)=>{for(var o in t)n.o(t,o)&&!n.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})}})(),(()=>{n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()})(),(()=>{n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t)})(),(()=>{n.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}})(),(()=>{n.nmd=e=>(e.paths=[],e.children||(e.children=[]),e)})(),(()=>{n.p=""})(),(()=>{var e={792:0};n.O.j=t=>0===e[t];var t=(t,o)=>{var r,s,[a,i,u]=o,c=0;if(a.some((t=>0!==e[t]))){for(r in i)n.o(i,r)&&(n.m[r]=i[r]);if(u)var l=u(n)}for(t&&t(o);c<a.length;c++)s=a[c],n.o(e,s)&&e[s]&&e[s][0](),e[s]=0;return n.O(l)},o=self["webpackChunkproject_app"]=self["webpackChunkproject_app"]||[];o.forEach(t.bind(null,0)),o.push=t.bind(null,o.push.bind(o))})();var o=n.O(void 0,[504],(()=>n(89)));o=n.O(o)})();